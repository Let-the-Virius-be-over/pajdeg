<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>Pajdeg: Add metadata diff example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Pajdeg
   &#160;<span id="projectnumber">0.2.2</span>
   </div>
   <div id="projectbrief">Pajdeg</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="a00008.html">Quick Start</a></li><li class="navelem"><a class="el" href="a00012.html">Adding metadata to a PDF</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Add metadata diff example </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This demonstrates what the modifications Pajdeg make to a PDF end up looking like, byte-wise. You can check this out yourself by doing <code>diff -a</code> on the original and new PDF files after using Pajdeg.</p>
<p><div class="fragment"><div class="line">diff -a ../testpdf.pdf out.pdf</div>
<div class="line">9a10,15</div>
<div class="line">&gt; 21 0 obj</div>
<div class="line">&gt; &lt;&lt;/Length 12 &gt;&gt;</div>
<div class="line">&gt; stream</div>
<div class="line">&gt; Hello World!</div>
<div class="line">&gt; endstream</div>
<div class="line">&gt; endobj</div>
</div><!-- fragment --></p>
<p>First off, we see a number of lines added to the new PDF that weren't in the old one. It's an object (ID 21, generation number 0) with a stream whose length is 12 bytes, and the stream itself consists of the 12 characters "Hello World!".</p>
<p><div class="fragment"><div class="line">133c139</div>
<div class="line">&lt; &lt;&lt;/Fini 20 0 R /Type /Catalog /Pages 10 0 R /OpenAction [ 1 0 R /XYZ</div>
<div class="line">null null 0 ] /Lang (ja-JP) &gt;&gt;</div>
<div class="line">---</div>
<div class="line">&gt; &lt;&lt;/Metadata 21 0 R /Fini 20 0 R /Type /Catalog /Pages 10 0 R</div>
<div class="line">/OpenAction [ 1 0 R /XYZ null null 0 ] /Lang (ja-JP) &gt;&gt;</div>
<div class="line">209c215</div>
</div><!-- fragment --></p>
<p>Next up we see a replaced PDF dictionary. If you look closer, you'll notice that the only change is that <code>/Metadata 21 0 R</code> was added to the new PDF.</p>
<p><div class="fragment"><div class="line">&lt; 0 21</div>
<div class="line">---</div>
<div class="line">&gt; 0 22</div>
<div class="line">211c217</div>
<div class="line">&lt; 0000009299 00000 n</div>
<div class="line">---</div>
<div class="line">&gt; 0000009361 00000 n</div>
<div class="line">212a219,236</div>
<div class="line">&gt; 0000000258 00000 n</div>
<div class="line">&gt; 0000009505 00000 n</div>
<div class="line">&gt; 0000000278 00000 n</div>
<div class="line">&gt; 0000000452 00000 n</div>
<div class="line">&gt; 0000009649 00000 n</div>
<div class="line">&gt; 0000000472 00000 n</div>
<div class="line">&gt; 0000000646 00000 n</div>
<div class="line">&gt; 0000009793 00000 n</div>
<div class="line">&gt; 0000000666 00000 n</div>
<div class="line">&gt; 0000008573 00000 n</div>
<div class="line">&gt; 0000008595 00000 n</div>
<div class="line">&gt; 0000008796 00000 n</div>
<div class="line">&gt; 0000009097 00000 n</div>
<div class="line">&gt; 0000009273 00000 n</div>
<div class="line">&gt; 0000009306 00000 n</div>
<div class="line">&gt; 0000009905 00000 n</div>
<div class="line">&gt; 0000010038 00000 n</div>
<div class="line">&gt; 0000010225 00000 n</div>
<div class="line">214,230d237</div>
<div class="line">&lt; 0000009443 00000 n</div>
<div class="line">&lt; 0000000216 00000 n</div>
<div class="line">&lt; 0000000390 00000 n</div>
<div class="line">&lt; 0000009587 00000 n</div>
<div class="line">&lt; 0000000410 00000 n</div>
<div class="line">&lt; 0000000584 00000 n</div>
<div class="line">&lt; 0000009731 00000 n</div>
<div class="line">&lt; 0000000604 00000 n</div>
<div class="line">&lt; 0000008511 00000 n</div>
<div class="line">&lt; 0000008533 00000 n</div>
<div class="line">&lt; 0000008734 00000 n</div>
<div class="line">&lt; 0000009035 00000 n</div>
<div class="line">&lt; 0000009211 00000 n</div>
<div class="line">&lt; 0000009244 00000 n</div>
<div class="line">&lt; 0000009843 00000 n</div>
<div class="line">&lt; 0000009959 00000 n</div>
<div class="line">&lt; 0000010146 00000 n</div>
<div class="line">232c239</div>
</div><!-- fragment --></p>
<p>At the very top, <code>0 21</code> is replaced with <code>0 22</code>. This is the XREF (cross reference) header, which is changed because the PDF has an extra object (our metadata object). This follows by a chunk of lines being replaced. These are XREF entries, and almost all of them have been updated, because almost every single object's byte position in the PDF has changed. That's unfortunate but normal. It can be alleviated to some extent when making small modifications by opting for the <a class="el" href="a00019.html#ga87dfa8409888bac8a7c694231186b7ec">PDParserCreateAppendedObject()</a> method over <a class="el" href="a00019.html#ga5c564a25ae062c5ded85d3de28bad85a">PDParserCreateNewObject()</a>, but shouldn't be thought too hard into.</p>
<p><div class="fragment"><div class="line">&lt; &lt;&lt;/Size 21 /Root 18 0 R /Info 19 0 R /ID [</div>
<div class="line">&lt;967EA1728C3CC524000105A6C8F88744&gt; &lt;967EA1728C3CC524000105A6C8F88744&gt;</div>
<div class="line">] /DocChecksum /253428E6A53FF28ECA00A27FE9073CE9 &gt;&gt;</div>
<div class="line">---</div>
<div class="line">&gt; &lt;&lt;/Size 22 /Root 18 0 R /Info 19 0 R /ID [</div>
<div class="line">&lt;967EA1728C3CC524000105A6C8F88744&gt; &lt;967EA1728C3CC524000105A6C8F88744&gt;</div>
<div class="line">] /DocChecksum /253428E6A53FF28ECA00A27FE9073CE9 &gt;&gt;</div>
<div class="line">234c241</div>
</div><!-- fragment --></p>
<p>Next up is the <em>trailer object</em> which has been updated as well: <code>/Size</code> has been set to 22, because we now have 22 objects in the PDF.</p>
<p>That's the whole diff. Chances are you won't get quite as clean results, because the original PDF here originated from Pajdeg, which often is not the case.</p>
<p>Back to <a class="el" href="a00012.html">Adding metadata to a PDF</a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 22 2015 16:49:00 for Pajdeg by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
